@model PagedList.IPagedList<HDU_AppXetTuyen.Models.NganhMaster>
@using PagedList.Mvc;

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_Layout_Admin_Master.cshtml";
}

<header class="page-header page-header-compact page-header-light border-bottom bg-white mb-2">
    <div class="container-fluid px-4">
        <div class="page-header-content">
            <div class="row align-items-center justify-content-between pt-3">
                <div class="col-auto mb-1">
                    <div class="page-header-title  mb-2">
                        <div class="page-header-icon"><i data-feather="list"></i></div>
                        <span>Quản lý thông tin Ngành</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="container-fluid px-12">
    <div class="card card-header-actions">
        <div class="card-header">
            <span>Danh sách các ngành</span>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-xl-12">
                    <table class="table table-hover table-striped mt-0">
                        <thead class="mt-0">
                            <tr>
                                <th>
                                    @Html.DisplayName("Mã ngành")
                                </th>
                                <th>
                                    @Html.DisplayName("Tên ngành")
                                </th>
                                <th>
                                    @Html.DisplayName("Định hướng nghiên cứu")
                                </th>
                                <th>
                                    @Html.DisplayName("Khoa quản lý")
                                </th>

                                <th style="width:100px; text-align:center">
                                    <a class="text-nowrap" style="text-decoration:none" href="@Url.Action("Create","NganhMasters")">
                                        Thêm mới
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Nganh_Mt_MaNganh)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Nganh_Mt_TenNganh)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Nganh_Mt_NghienCuu_Ten)
                                    </td>

                                    <td>
                                        @Html.DisplayFor(modelItem => item.Nganh_Mt_TenKhoa)
                                    </td>
                                    <td style="width:100px; text-align:center">
                                        @Html.ActionLink("Sửa", "Edit", new { id = item.Nganh_Mt_ID }) |
                                        <a href="#" id="@item.Nganh_Mt_ID" onclick="DeleteNganh(@item.Nganh_Mt_ID)">Xóa</a>

                                        @*@Html.ActionLink("Xoá", "Delete", new { id = item.Nganh_Mt_ID })*@
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    <!-- Thêm mã phân trang -->
                    Trang @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) / @Model.PageCount
                    @Html.PagedListPager(Model, page => Url.Action("Index", new { page, @class = "mt-1 mb-1" }))
                    <!-- Kết thúc -->
                </div>
            </div>

        </div>
    </div>
</div>
<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="myToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <strong class="me-auto">Toast Title</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
        </div>
    </div>
</div>

<div class="modal fade" id="modal_tb_xoa" tabindex="-1" role="dialog" aria-labelledby="modal_tb_xoa" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modal_tb_xoa">Thông báo</h5>
                <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close" id="bt_cancel_delete_on_modal_first"></button>
            </div>
            <div class="modal-body">
                <span>Bạn chắc chắn xóa dữ liệu chuyên ngành này này?</span>
                <input id="key_delete_id" type="hidden" />
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-bs-dismiss="modal" id="bt_cancel_delete_on_modal_second">Hủy</button>
                <button class="btn btn-primary" type="button" id="bt_OK_delete_on_modal">Đồng ý</button>
            </div>
        </div>
    </div>
</div>
<script>
    function DeleteNganh(id_nganh) {
        $('#key_delete_id').val(id_nganh);
        $('#modal_tb_xoa').modal('show');
    }
    $(document).ready(function () {
        $('#bt_cancel_delete_on_modal_first').click(function () {
            $('#key_delete_id').val('');
            $('#modal_tb_xoa').modal('hide');
        });
        $('#bt_cancel_delete_on_modal_second').click(function () {
            $('#key_delete_id').val('');
            $('#modal_tb_xoa').modal('hide');
        });
        $('#bt_OK_delete_on_modal').click(function () {
            let data_delete = { Nganh_Mt_ID: $('#key_delete_id').val() }
            $.ajax({
                url: "/Admin/NganhMasters/RegisterMasterCheckCCCDAD/",
                type: "POST",
                data: JSON.stringify(checkCcAd),
                async: false,
                contentType: 'application/json;charset=utf-8',
                success: function (res) {
                    if (res.success == true) {
                        $('#Error_Rgt_HocVien_CCCD').text("Số CCCD đã tồn tại."); flag = false;
                    }
                },
                error: function () { }
            });
        });
    });
</script>