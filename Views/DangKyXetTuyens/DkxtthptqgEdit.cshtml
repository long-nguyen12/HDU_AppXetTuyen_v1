
@{
    ViewBag.Title = "Đăng ký xét tuyển";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .label_tieude {
        white-space: nowrap !important;
    }

    .span_with_for {
        width: 65px !important
    }

    .btn, .form-select, .form-control {
        border-radius: 3px;
    }

    .padding_input_text_number {
        padding-left: 0px !important;
        padding-right: 0px !important;
        text-align: center !important;
    }
</style>
<header class="page-header page-header-compact page-header-light border-bottom bg-white mb-2">
    <div class="container-fluid px-4">
        <div class="page-header-content">
            <div class="row align-items-center justify-content-between pt-3">
                <div class="col-auto mb-1">
                    <div class="page-header-title mb-2">
                        <div class="page-header-icon"><i data-feather="list"></i></div>
                        <span id="sp_tieude">Đăng ký xét tuyển sử dụng kết quả thi tốt nghiệp THPT Quốc gia</span>
                    </div>
                </div>

            </div>
        </div>
    </div>
</header>

<div class="container-fluid px-12">
    <div id="div_update_aspirations">
        <div class="card card-header-actions">
            <div class="card-header">
                <span>Chỉnh sửa nguyện vọng</span>
                <button class="btn-close" id="bt_close_div_update_aspirations_first" type="button" aria-label="Close"></button>
            </div>
            <div class="card-body g-1">
                <div class="row">
                    <div class="col-xxl-4">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th colspan="2">Chọn ngành và tổ hợp môn <font color="red">(*)</font></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Khối ngành</td>
                                    <td>
                                        <select id="select_khoinganh" class="form-select"></select>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Ngành</td>
                                    <td>
                                        <select id="select_nganh" class="form-select"></select>
                                        <span id="Nganh_ID_Error" class="small mb-1 text-danger"></span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="label_tieude">Tổ hợp môn</td>
                                    <td>
                                        <select id="select_tohopmon" class="form-select"></select>
                                        <span id="Thm_ID_Error" class="small mb-1 text-danger"></span>
                                    </td>
                                </tr>

                                <tr>
                                    <td colspan="2">
                                        <div class="row">
                                            <div class="col-6 mb-0 ">
                                                <span id="span_Uutien_doituong"></span>
                                                <hr style="margin-bottom: 2px " />
                                            </div>
                                            <div class="col-6 mb-0 ">
                                                <span id="span_Uutien_khuvuc"></span>
                                                <hr style="margin-bottom:2px" />
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-6 mt-0">
                                                <span> Học lực lớp 12</span>
                                                <input id="txt_hocluc_12" type="text" class="form-control" value="" disabled />

                                            </div>
                                            <div class="col-6 mt-0">
                                                <span>Hạnh kiểm lớp 12</span>
                                                <input id="txt_hanhkiem_12" type="text" class="form-control" value="" disabled />
                                            </div>
                                        </div>
                                    </td>
                                </tr>

                        </table>
                    </div>
                    <div class="col-xxl-4">
                        <div class="row md-0">
                            <div class="col-xxl-12 mb-0">
                                <table class="table ">
                                    <thead>
                                        <tr>
                                            <th style="vertical-align:middle;" colspan="3">Điểm các môn xét tuyển <font color="red">(*)</font></th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbody_list_diemmonhoc">
                                        <tr>
                                            <td colspan="4">
                                                <div class="row g-1 align-items-center">
                                                    <div class="col-5">
                                                        <label for="select_namtn" class="col-form-label">Năm tốt nghiệp:</label>
                                                    </div>
                                                    <div class="col-7">
                                                        <select class="form-select" id="select_namtn"></select>
                                                        <span id="NamTotNghiep_Error" class="small mb-1 text-danger"></span>
                                                    </div>

                                                </div>
                                            </td>

                                        </tr>
                                        <tr>
                                            <td><label id="lb_tenmon_1" class="form-label"></label><input id="txt_m1" type="number" class="form-control input-monhoc padding_input_text_number" /></td>
                                            <td><label id="lb_tenmon_2" class="form-label"></label><input id="txt_m2" type="number" class="form-control input-monhoc padding_input_text_number" /></td>
                                            <td><label id="lb_tenmon_3" class="form-label"></label><input id="txt_m3" type="number" class="form-control input-monhoc padding_input_text_number" /></td>
                                            <td><label id="lb_tongdiem" class="form-label">Tổng</label><input id="txt_tong_diem" type="text" class="form-control input-tong padding_input_text_number" disabled /></td>
                                        </tr>
                                    </tbody>
                                </table>

                            </div>
                            <div class="col-xxl-12 mt-0 mb-0" style="text-align:center; ">
                                <span id="Diem_All_Error" class="small mb-1 text-danger"></span>
                            </div>
                        </div>
                        <div class="row mt-0 mb-1">
                            <div class="col-xxl-12">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Giấy chứng nhận KQ tốt nghiệp THPT<font color="red">(*)</font></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="row mt-0 md-0">
                                                    <div class="col-lg-12 col-12" style="margin-top:0; margin-bottom:0">
                                                        (<span id="sp_view_mc_cntn"> </span>)
                                                    </div>

                                                    <div class="col-xxl-12">
                                                        <div class="form-group mb-1 mt-1">
                                                            <div class="col-md-12">
                                                                <input id="files_chungnhan_kqtn" type="file" multiple class="form-control" accept=".pdf,.png, .PNG,.jpeg,.JPEG,.jpg,.JPG" />
                                                                <span id="ChungNhanTotNghiep_Error" class="small mb-1 text-danger"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xxl-12">
                                                        <table class="table mt-0 mb-0" id="FilesList_CNKQTN_View" style="visibility:hidden">
                                                            <tr style="display:none">
                                                                <th colspan="2"><input type="hidden" id="txt_uploader_file_hocba" /></th>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>

                                            </td>
                                        </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-xxl-4">
                        <div class="row mb-0">
                            <div class="col-xxl-12">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Dữ liệu minh chứng khác</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="row mt-0 md-0">
                                                    <div class="col-xxl-12">
                                                        <div class="form-group mb-0 mt-1">
                                                            <label class="form-label">Học bạ (<span id="sp_view_mc_hocba"> </span>)</label>
                                                            <div class="col-md-12">
                                                                <input class="form-control" id="files_hocba_ts" multiple="multiple" name="files_hocba_ts" type="file" data-val="true" data-val-required="Vui lòng chọn file Vui lòng chọn file học bạ"
                                                                       accept=".pdf,.png, .PNG,.jpeg,.JPEG,.jpg,.JPG" />
                                                                <span class="field-validation-valid text-primary" data-valmsg-for="files_hocba_ts" data-valmsg-replace="true"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xxl-12">
                                                        <table class="table mt-1 mb-0" id="FilesList_HocBa_View" style="visibility:hidden"> <tr style="display:none"><th colspan="2"><input type="hidden" id="txt_uploader_file_cccd" /></th></tr></table>
                                                    </div>
                                                </div>

                                                <div class="row mt-0 md-0">
                                                    <div class="col-xxl-12">
                                                        <div class="form-group mb-0">
                                                            <label class="form-label">Bằng tốt nghiệp (<span id="sp_view_mc_bang"></span>)</label>
                                                            <div class="col-md-12">
                                                                <input class="form-control" id="files_bangtn" multiple="multiple" name="files" type="file" data-val="true" data-val-required="Vui lòng chọn file Bằng TN" accept=".pdf,.png, .PNG,.jpeg,.JPEG,.jpg,.JPG" />
                                                                <span class="field-validation-valid text-primary" data-valmsg-for="files" data-valmsg-replace="true"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xxl-12">
                                                        <table class="table mt-0 mb-0" id="FilesList_BangTN_View" style="visibility:hidden"> <tr style="display:none"><th colspan="2"><input type="hidden" id="txt_uploader_file_bangtn" /></th></tr></table>
                                                    </div>
                                                </div>

                                                <div class="row mt-0 md-0">
                                                    <div class="col-xxl-12">
                                                        <div class="form-group mb-0">
                                                            <label class="form-label">Căn cước công dân  (<span id="sp_view_mc_cccd"></span>)</label>
                                                            <div class="col-md-12">
                                                                <input class="form-control" id="files_cancuoc_congdan" multiple="multiple" name="files" type="file" accept=".pdf,.png, .PNG,.jpeg,.JPEG,.jpg,.JPG" />
                                                                <span class="field-validation-valid text-primary" data-valmsg-for="files" data-valmsg-replace="true"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xxl-12">
                                                        <table class="table mt-0 mb-0" id="FilesList_CCCD_View" style="visibility:hidden"> <tr style="display:none"><th colspan="2"><input type="hidden" id="txt_uploader_file_bangtn" /></th></tr></table>
                                                    </div>
                                                </div>

                                                <div class="row mt-0 md-0">
                                                    <div class="col-xxl-12">
                                                        <div class="form-group mb-0 mt-1">
                                                            <label class="form-label">Giấy tờ ưu tiên (<span id="sp_view_mc_uutien"> </span>) </label>
                                                            <div class="col-md-12">
                                                                <input class="form-control" id="files_giayto_uutien" multiple="multiple" name="files" type="file" data-val="true" data-val-required="Vui lòng chọn giấy tờ ưu tiên" accept=".pdf,.png, .PNG,.jpeg,.JPEG,.jpg,.JPG" />
                                                                <span class="field-validation-valid text-primary" data-valmsg-for="files" data-valmsg-replace="true"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-xxl-12">
                                                        <table class="table mt-0 mb-0" id="FilesList_GTUT_View" style="visibility:hidden"> <tr style="display:none"><th colspan="2"><input type="hidden" id="txt_uploader_file_g" /></th></tr></table>
                                                    </div>
                                                </div>

                                            </td>
                                        </tr>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>


                <div class="row mb-3">
                    <div class="col-xxl-12" style="text-align:center">
                        <input class="btn btn-outline-primary col-lg-1 col-4" id="bt_ok_div_update_aspirations" type="button" value="Đồng ý sửa" />
                        <input class="btn btn-outline-secondary col-lg-1 col-4" id="bt_close_div_update_aspirations_second" type="button" value="Quay lại" />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="div_view_img" style="display:none">
        <div class="card card-header-actions">
            <div class="card-header mt-0 mb-0">
                <span id="img_txt_card_hearder">Hình ảnh minh chứng</span>
                <div>
                    <button class="btn btn-outline-danger btn-sm" type="button" id="bt_delete_img_mc" onclick="bt_delete_img_mc_click()">Xóa</button>
                    <script>function bt_delete_img_mc_click() { $('#modal_thongbao_delete').modal('show'); }</script>

                    <button class="btn btn-outline-primary btn-sm" type="button" id="bt_close_div_view_img">Đóng</button>
                </div>
            </div>
            <div class="card-body" style="margin: 0px!important">
                <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item active" id="div_item_view_minhchung">
                            <img class="d-block w-100 img-hide" id="img_view" display:none">
                            <embed id="pdf_view" class="d-block w-100" style="height:0px; display:none" type="application/pdf" />
                            <input type="hidden" id="hiden_id_key" style="display:none" />
                            <input type="hidden" id="hiden_loai_minhchung_xoa" style="display:none" />
                            <input type="hidden" id="hiden_duongdan_file_xoa" style="display:none" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="myToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto">Toast Title</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
            </div>
        </div>
    </div>
</div>
<style>
    #loadingModal {
        background-color: rgba(0, 0, 0, 0.5);
        background-color: transparent;
    }
</style>
<div class="modal" id="loadingModal" tabindex="-1" role="dialog" aria-labelledby="loadingModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content">
            <div class="modal-body text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_thongbao_delete" tabindex="-1" role="dialog" aria-labelledby="modal_thongbao_delete" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="tieude_modal">Thông báo</h5>
                <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close" onclick="bt_close_modal_xoa_click()"></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Bạn chắc chắn xóa ảnh minh chứng này ?</label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" type="button" onclick="bt_dongy_xoa_on_modal_delete_click()">Đồng ý</button>
                <script>
                    function bt_dongy_xoa_on_modal_delete_click() {
                        var str_query = window.location.search;

                        var data_post = {
                            Dkxt_ID: $('#hiden_id_key').val(),
                            Dkxt_LoaiMC: $('#hiden_loai_minhchung_xoa').val(),
                            Dkxt_Url: $("#hiden_duongdan_file_xoa").val(),
                        }
                        console.log('téssssst delete', data_post)

                        $.ajax({
                            url: '/DangKyXetTuyens/DangKyXetTuyen_KQTTHPTQG_DeleteMC',
                            type: "POST",
                            data: JSON.stringify(data_post),
                            contentType: "application/json;charset=utf-8",
                            success: function (res) {
                                $('#modal_thongbao_delete').modal('hide');
                                //hiển thị các hình ảnh minh chứng
                                LoadImageMC_THPTQG_ByID();
                                //thiết lập các upload file
                                reset_change_img_file();

                                showToast("Thông báo", "Xóa ảnh minh chứng thành công!", "bg-error");
                                //window.location.href = "/DangKyXetTuyens/DkxtthptqgEdit" + str_query;
                            },
                            error: function (error) {
                                console.error('Error update mc:', error);
                            }
                        });
                    }
                </script>
                <button class="btn btn-primary" type="button" onclick="bt_close_modal_xoa_click()">Đóng</button>
            </div>
            <script>
                function bt_close_modal_xoa_click() {
                    $('#modal_thongbao_delete').modal('hide');
                }
            </script>
        </div>
    </div>
</div>

<input type="hidden" value="@ViewBag.Dkxt_ID" id="hidden_Dkxt_KQTQG_ID" />
<input type="hidden" id="dkxt_thptqg_id_checkin" name="dkxt_thptqg_id_checkin" />

<script>
    function showimg(url, loaimc, id_key_hs) {

        $('#hiden_id_key').val(id_key_hs);
        $('#hiden_loai_minhchung_xoa').val(loaimc);
        $("#hiden_duongdan_file_xoa").val(url);

        var pdf_view = document.getElementById("pdf_view");

        $('#pdf_view').height('0px');
        $('#pdf_view').css('display', 'none');
        $("#pdf_view").attr("src", "");
        $("#pdf_view").hide();

        $("#img_view").attr("src", "");
        $('#img_view').hide();

        if (loaimc == 1) {
            $('#img_txt_card_hearder').text('Minh chứng chứng nhận tốt nghiệp');
        }
        if (loaimc == 2) {
            $('#img_txt_card_hearder').text('Minh chứng học bạ');
        }
        if (loaimc == 3) {
            $('#img_txt_card_hearder').text('Minh chứng bằng');
        }
        if (loaimc == 4) {
            $('#img_txt_card_hearder').text('Minh chứng căn cước công dân');
        }
        if (loaimc == 5) {
            $('#img_txt_card_hearder').text('Minh chứng giấy tờ khác');
        }
        var lastChar = url.substr(url.length - 4); // => kiểm tra file pdf hoặc img

        if (lastChar.toLowerCase() != ".pdf") {
            $('#pdf_view').height('0px');
            $('#pdf_view').css('display', 'none');
            $("#pdf_view").attr("src", "");
            $("#pdf_view").hide();

            $("#img_view").attr("src", url);
            $("#img_view").show();
        }
        if (lastChar.toLowerCase() === ".pdf") {
            $("#img_view").hide();
            $('#pdf_view').height('500px');
            $('#pdf_view').css('display', 'inline');

            $("#pdf_view").attr("src", url);
            $("#pdf_view").show();
        }
        $('#div_view_img').show();
    }
    $(document).ready(function () {
        $('#bt_close_div_view_img').click(function () {
            $('#div_view_img').hide();
            $("#img_view").attr("src", "");
            $("#img_view").hide();

            $('#pdf_view').height('0px');
            $('#pdf_view').css('display', 'none');
            $("#pdf_view").attr("src", "");
            $("#pdf_view").hide();
            $('#img_txt_card_hearder').text('Hình ảnh minh chứng');
        });
    });
</script>

<script>
    $(document).ready(function () {
        // hiển thị thông tin năm tốt nghiệp
        let currentYear = new Date().getFullYear();
        let nam_list = [
            { value: 0, text: "Chọn năm" },         
            { value: currentYear - 1, text: currentYear - 1 },
            { value: currentYear - 2, text: currentYear - 2 },
        ]
        let select_NamTN = $('#select_namtn');

        $.each(nam_list, function (index, option) {
            select_NamTN.append($('<option>', {
                value: option.value,
                text: option.text
            }));
        });

        // hiển thị thông tin đăng ký nguyện vọng
        LoadDataInfor_THPTQG_ByID();
        //hiển thị các hình ảnh minh chứng
        LoadImageMC_THPTQG_ByID();
        //thiết lập các upload file
        reset_change_img_file();
       
        
    })
    function LoadDataInfor_THPTQG_ByID() {
        let data_get = { Dkxt_KQTQG_ID: $('#hidden_Dkxt_KQTQG_ID').val() }
        $.ajax({
            url: "/DangKyXetTuyens/DangKyXetTuyen_KQTHPTQG_GetByID",
            data: JSON.stringify(data_get),
            type: 'POST',
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            async: false,
            success: function (res) {
                console.log("test", res)
                if (res.success) {
                    let data = res.data;
                    select_khoinganh_view_data(data.KhoiNganh_ID, data.Nganh_ID, data.Thm_ID);
                    $('#txt_hocluc_12').val(data.ThiSinh_HocLucLop12);
                    $('#txt_hanhkiem_12').val(data.ThiSinh_HanhKiemLop12);

                    $('#span_Uutien_doituong').text(data.DoiTuong_ID);
                    $('#span_Uutien_khuvuc').text(data.KhuVuc_ID);

                    $('#select_namtn').val(data.Dkxt_KQTQG_NamTotNghiep);

                    $('#lb_tenmon_1').text(data.Dkxt_Diem_M1.TenMon);
                    $('#txt_m1').val(data.Dkxt_Diem_M1.Diem);

                    $('#lb_tenmon_2').text(data.Dkxt_Diem_M2.TenMon);
                    $('#txt_m2').val(data.Dkxt_Diem_M2.Diem);

                    $('#lb_tenmon_3').text(data.Dkxt_Diem_M3.TenMon);
                    $('#txt_m3').val(data.Dkxt_Diem_M3.Diem);

                    $('#txt_tong_diem').val(data.Dkxt_KQTQG_Diem_Tong);
                }
            },
            error: function (errormessage) {
                console.log(errormessage.error);
            }
        });
    }
    function LoadImageMC_THPTQG_ByID() {
        let data_get = { Dkxt_KQTQG_ID: $('#hidden_Dkxt_KQTQG_ID').val() }
        $.ajax({
            url: "/DangKyXetTuyens/DangKyXetTuyen_KQTHPTQG_GetByID",
            data: JSON.stringify(data_get),
            type: 'POST',
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            async: false,
            success: function (res) {
                console.log("test", res)
                if (res.success) {
                    let data = res.data;

                    $('#sp_view_mc_cntn').empty();

                    if (data.Dkxt_KQTQG_MinhChung_CNTotNghiep) {
                        const ArrCNTN = data.Dkxt_KQTQG_MinhChung_CNTotNghiep.split("#");
                        if (ArrCNTN.length > 0) {
                            for (i = 0; i < ArrCNTN.length; i++) {
                                if (ArrCNTN[i].length > 0) {
                                    var str_a = ` <a href="#"  onclick="showimg('${ArrCNTN[i]}',1,${data.Dkxt_KQTQG_ID})" class="link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Tệp ${i + 1}</a> `;
                                    $('#sp_view_mc_cntn').append(str_a);
                                }
                            }
                        }
                        else {
                            var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                            $('#sp_view_mc_cntn').append(str_a);
                        }
                    }
                    else {
                        var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                        $('#sp_view_mc_cntn').append(str_a);
                    }

                    $('#sp_view_mc_hocba').empty();

                    if (data.Dkxt_KQTQG_MinhChung_HocBa) {
                        const ArrMCHocBa = data.Dkxt_KQTQG_MinhChung_HocBa.split("#");
                        if (ArrMCHocBa.length > 0) {

                            for (i = 0; i < ArrMCHocBa.length; i++) {
                                if (ArrMCHocBa[i].length > 0) {
                                    var str_a = ` <a href="#"  onclick="showimg('${ArrMCHocBa[i]}',2,${data.Dkxt_KQTQG_ID})" class="link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Tệp ${i + 1}</a> `;
                                    $('#sp_view_mc_hocba').append(str_a);
                                }
                            }
                        }
                        else {
                            var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                            $('#sp_view_mc_hocba').append(str_a);
                        }

                    }
                    else {
                        var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                        $('#sp_view_mc_hocba').append(str_a);
                    }

                    $('#sp_view_mc_bang').empty();

                    if (data.Dkxt_KQTQG_MinhChung_BangTN) {
                        const ArrMCBang = data.Dkxt_KQTQG_MinhChung_BangTN.split("#");
                        if (ArrMCBang.length > 0) {

                            for (i = 0; i < ArrMCBang.length; i++) {
                                if (ArrMCBang[i].length > 0) {
                                    var str_a = ` <a href="#"  onclick="showimg('${ArrMCBang[i]}',3,${data.Dkxt_KQTQG_ID})" class="link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Tệp ${i + 1}</a> `;
                                    $('#sp_view_mc_bang').append(str_a);
                                }
                            }
                        }
                        else {
                            var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                            $('#sp_view_mc_bang').append(str_a);
                        }

                    }
                    else {
                        var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                        $('#sp_view_mc_bang').append(str_a);
                    }

                    $('#sp_view_mc_cccd').empty();

                    if (data.Dkxt_KQTQG_MinhChung_CCCD) {
                        const ArrMCCCCD = data.Dkxt_KQTQG_MinhChung_CCCD.split("#");
                        if (ArrMCCCCD.length > 0) {

                            for (i = 0; i < ArrMCCCCD.length; i++) {
                                if (ArrMCCCCD[i].length > 0) {
                                    var str_a = ` <a href="#"  onclick="showimg('${ArrMCCCCD[i]}',4,${data.Dkxt_KQTQG_ID})" class="link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Tệp ${i + 1}</a> `;
                                    $('#sp_view_mc_cccd').append(str_a);
                                }
                            }
                        }
                        else {
                            var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                            $('#sp_view_mc_cccd').append(str_a);
                        }

                    }
                    else {
                        var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                        $('#sp_view_mc_cccd').append(str_a);
                    }

                    $('#sp_view_mc_uutien').empty();

                    if (data.Dkxt_KQTQG_MinhChung_UuTien) {
                        const ArrMCUutien = data.Dkxt_KQTQG_MinhChung_UuTien.split("#");
                        if (ArrMCUutien.length > 0) {

                            for (i = 0; i < ArrMCUutien.length; i++) {
                                if (ArrMCUutien[i].length > 0) {
                                    var str_a = `<a href="#"  onclick="showimg('${ArrMCUutien[i]}',5,${data.Dkxt_KQTQG_ID})" class="link-offset-3-hover link-underline link-underline-opacity-0 link-underline-opacity-75-hover">Tệp ${i + 1}</a> `;
                                    $('#sp_view_mc_uutien').append(str_a);
                                }
                            }
                        }
                        else {
                            var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                            $('#sp_view_mc_uutien').append(str_a);
                        }

                    }
                    else {
                        var str_a = `<a style="color:red">Không có dữ liệu</a>`;
                        $('#sp_view_mc_uutien').append(str_a);
                    }
                }
            },
            error: function (errormessage) {
                console.log(errormessage.error);
            }
        });
    }

    function reset_change_img_file() {

        $('#files_chungnhan_kqtn').val(null);
        $('#files_hocba_ts').val(null);
        $('#files_bangtn').val(null);
        $('#files_cancuoc_congdan').val(null);
        $('#files_giayto_uutien').val(null);


        $("#FilesList_CNKQTN_View tbody").empty();
        $("#FilesList_HocBa_View tbody").empty();
        $("#FilesList_BangTN_View tbody").empty();
        $("#FilesList_CCCD_View tbody").empty();
        $("#FilesList_GTUT_View tbody").empty();
        formdata_file_chungnhan_kqtn = new FormData();
        formdata_file_hocba_ts = new FormData();
        formdata_file_bang_tn = new FormData();
        formdata_file_cancuoc_congdan = new FormData();
        formdata_file_giayto_uutien = new FormData();

        $('#div_view_img').hide();
        $("#img_view").attr("src", "");
        $("#img_view").hide();

        $('#pdf_view').height('0px');
        $('#pdf_view').css('display', 'none');
        $("#pdf_view").attr("src", "");
        $("#pdf_view").hide();

        $('#img_txt_card_hearder').text('Hình ảnh minh chứng');
    }

</script>
<script>
    $(document).ready(function () {
        /* Khai báo dữ liệu cho dropdownlist chọn năm */

        $("#select_khoinganh").change(function () {
            select_nganh_view_data($("#select_khoinganh").val(), 0, 0);
        });

        $("#select_nganh").change(function () {
            select_tohopmon_view_data($("#select_nganh").val(), 0, 0);

        });

        $("#select_tohopmon").change(function () {
            let dataObj = {
                Thm_ID: $("#select_tohopmon").val(),
                Dkxt_KQTQG_ID: $('#dkxt_thptqg_id_checkin').val(),
            }

            $.ajax({
                url: "/DangKyXetTuyens/DangKyXetTuyen_KQTHPTQG_Get_Data_MonHoc",
                data: JSON.stringify(dataObj),
                type: 'POST',
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (res) {
                    reset_fields_controll_disabled_false();
                    $('#lb_tenmon_1').text(res.thm_Mon1);
                    $('#lb_tenmon_2').text(res.thm_Mon2);
                    $('#lb_tenmon_3').text(res.thm_Mon3);
                    $('#txt_m1').focus();
                },
                error: function (errormessage) {
                    console.log(errormessage.error);
                }
            });
        });

        on_listen_fields_input_data(".input-monhoc", '#txt_tong_diem');

        $('input').on('input', function () {
            hideErrorMessage($(this));
        });

        $('select').on('input', function () {
            hideErrorMessage($(this));
        })
    });
    // phần xử lý dữ liệu cho các tệp đính kèm

    var formdata_file_chungnhan_kqtn = new FormData();
    var formdata_file_hocba_ts = new FormData();
    var formdata_file_bang_tn = new FormData();
    var formdata_file_cancuoc_congdan = new FormData();
    var formdata_file_giayto_uutien = new FormData();

    $(document).ready(function () {

        $("#files_cancuoc_congdan").on("change", function () {
            var files_cancuoc_congdan = document.getElementById('files_cancuoc_congdan');
            for (i = 0; i < files_cancuoc_congdan.files.length; i++) {
                var sfilename_cc = files_cancuoc_congdan.files[i].name;
                let srandomid_cc = Math.random().toString(36).substring(7);
                formdata_file_cancuoc_congdan.append(sfilename_cc, files_cancuoc_congdan.files[i]);

                var markup_cccd = "<tr id='" + srandomid_cc + "'><td>" + sfilename_cc + "</td><td style='width: 60px!important; color:blue'><a style='text-decoration:none' title='Bấm chuột để xóa tệp nếu không đúng!' class=\"btn btn-light btn-sm\" onclick='DeleteFile_CCCD_Upload(\"" + srandomid_cc + "\",\"" + sfilename_cc + "\")'>Xóa</a></td></tr>";
                $("#FilesList_CCCD_View tbody").append(markup_cccd);
            }
            chkatchtbl_cc_cd();
            $('#files_cancuoc_congdan').val('');
        });

        $("#files_chungnhan_kqtn").on("change", function () {
            var files_chungnhan_kqtn = document.getElementById('files_chungnhan_kqtn');
            for (i = 0; i < files_chungnhan_kqtn.files.length; i++) {
                var sfilename_chungnhan_kqtn = files_chungnhan_kqtn.files[i].name;
                let srandomid_chungnhan_kqtn = Math.random().toString(36).substring(7);
                formdata_file_chungnhan_kqtn.append(sfilename_chungnhan_kqtn, files_chungnhan_kqtn.files[i]);

                var markup_chungnhan_kqtn = "<tr id='" + srandomid_chungnhan_kqtn + "'><td>" + sfilename_chungnhan_kqtn + "</td><td style='width: 60px!important; color:blue'><a style='text-decoration:none' title='Bấm chuột để xóa tệp nếu không đúng!' class=\"btn btn-light btn-sm\" onclick='DeleteFile_CNKQTN_Upload(\"" + srandomid_chungnhan_kqtn + "\",\"" + sfilename_chungnhan_kqtn + "\")'>Xóa</a></td></tr>";
                $("#FilesList_CNKQTN_View tbody").append(markup_chungnhan_kqtn);
            }
            chkatchtbl_chungnhan_kqtn();
            $('#files_chungnhan_kqtn').val('');
        });

        $("#files_bangtn").on("change", function () {
            var files_bangtn = document.getElementById('files_bangtn');
            for (i = 0; i < files_bangtn.files.length; i++) {
                var sfilename_bang_tn = files_bangtn.files[i].name;
                let srandomid_bang_tn = Math.random().toString(36).substring(7);
                formdata_file_bang_tn.append(sfilename_bang_tn, files_bangtn.files[i]);
                var markup_bang_tn = "<tr id='" + srandomid_bang_tn + "'><td>" + sfilename_bang_tn + "</td><td style='width: 60px!important; color:blue'><a style='text-decoration:none' title='Bấm chuột để xóa tệp nếu không đúng!' class=\"btn btn-light btn-sm\" onclick='DeleteFile_BANGTN_Upload(\"" + srandomid_bang_tn + "\",\"" + sfilename_bang_tn + "\")'>Xóa</a></td></tr>";
                $("#FilesList_BangTN_View tbody").append(markup_bang_tn);
            }
            chkatchtbl_bang_tn();
            $('#files_bangtn').val('');
        });
        $("#files_hocba_ts").on("change", function () {
            var files_hocba_ts = document.getElementById('files_hocba_ts');
            for (i = 0; i < files_hocba_ts.files.length; i++) {
                var sfilename_hocba_ts = files_hocba_ts.files[i].name;
                let srandomid_hocba_ts = Math.random().toString(36).substring(7);
                formdata_file_hocba_ts.append(sfilename_hocba_ts, files_hocba_ts.files[i]);
                var markup_hocba_ts = "<tr id='" + srandomid_hocba_ts + "'><td>" + sfilename_hocba_ts + "</td><td style='width: 60px!important; color:blue'><a style='text-decoration:none' title='Bấm chuột để xóa tệp nếu không đúng!' class=\"btn btn-light btn-sm\" onclick='DeleteFile_HoBas_Upload(\"" + srandomid_hocba_ts + "\",\"" + sfilename_hocba_ts + "\")'>Xóa</a></td></tr>";
                $("#FilesList_HocBa_View tbody").append(markup_hocba_ts);
            }
            chkatchtbl_hocba();
            $('#files_hocba_ts').val('');
        });
        $("#files_giayto_uutien").on("change", function () {
            var files_giayto_uutien = document.getElementById('files_giayto_uutien');
            let j = 0;
            for (i = 0; i < files_giayto_uutien.files.length; i++) {
                j++;
                var sfilename_gtuutien = files_giayto_uutien.files[i].name;
                let srandomid_gtuutien = Math.random().toString(36).substring(7);

                formdata_file_giayto_uutien.append(sfilename_gtuutien, files_giayto_uutien.files[i]);
                var markup_giayto_uutien = "<tr id='" + srandomid_gtuutien + "'><td>" + sfilename_gtuutien + "</td><td style='width: 60px!important; color:blue'><a style='text-decoration:none' title='Bấm chuột để xóa tệp nếu không đúng!' class=\"btn btn-light btn-sm\" onclick='DeleteFile_GTUT_Upload(\"" + srandomid_gtuutien + "\",\"" + sfilename_gtuutien + "\")'>Xóa</a></td></tr>";
                $("#FilesList_GTUT_View tbody").append(markup_giayto_uutien);

            }
            chkatchtbl_giayto_uutien();
            $('#files_giayto_uutien').val('');
        });
    });
    function DeleteFile_CCCD_Upload(Fileid, FileName) {
        formdata_file_cancuoc_congdan.delete(FileName)
        $("#" + Fileid).remove();
        chkatchtbl_cc_cd();
    }
    function chkatchtbl_cc_cd() {
        if ($('#FilesList_CCCD_View tr').length > 0) {
            $("#FilesList_CCCD_View").css("visibility", "visible");
        }
        else {
            $("#FilesList_CCCD_View").css("visibility", "hidden");
        }
    }

    function DeleteFile_CNKQTN_Upload(Fileid, FileName) {
        formdata_file_chungnhan_kqtn.delete(FileName)
        $("#" + Fileid).remove();
        chkatchtbl_chungnhan_kqtn();
    }
    function chkatchtbl_chungnhan_kqtn() {
        if ($('#FilesList_CNKQTN_View tr').length > 0) {
            $("#FilesList_CNKQTN_View").css("visibility", "visible");
        }
        else {
            $("#FilesList_CNKQTN_View").css("visibility", "hidden");
        }
    }
    function DeleteFile_BANGTN_Upload(Fileid, FileName) {
        formdata_file_bang_tn.delete(FileName)
        $("#" + Fileid).remove();
        chkatchtbl_bang_tn();
    }
    function chkatchtbl_bang_tn() {
        if ($('#FilesList_BangTN_View tr').length > 0) { $("#FilesList_BangTN_View").css("visibility", "visible"); }
        else { $("#FilesList_BangTN_View").css("visibility", "hidden"); }
    }
    function DeleteFile_HoBas_Upload(Fileid, FileName) {
        formdata_file_hocba_ts.delete(FileName)
        $("#" + Fileid).remove();
        chkatchtbl_hocba();
    }
    function chkatchtbl_hocba() {
        if ($('#FilesList_HocBa_View tr').length > 0) {
            $("#FilesList_HocBa_View").css("visibility", "visible");
        } else {
            $("#FilesList_HocBa_View").css("visibility", "hidden");
        }
    }
    function DeleteFile_GTUT_Upload(Fileid, FileName) {
        formdata_file_giayto_uutien.delete(FileName)
        $("#" + Fileid).remove();
        chkatchtbl_giayto_uutien();
    }
    function chkatchtbl_giayto_uutien() {
        if ($('#FilesList_GTUT_View tr').length > 0) {
            $("#FilesList_GTUT_View").css("visibility", "visible");
        } else {
            $("#FilesList_GTUT_View").css("visibility", "hidden");
        }
    }
    // hết phần xử lý dữ liệu cho các tệp đính kèm


    $(document).ready(function () {
        // button đồng sửa
        $('#bt_ok_div_update_aspirations').click(function () {

            let flag = true;
            let _dkxt_KQTQG_ID = $('#hidden_Dkxt_KQTQG_ID').val()

            let _nganh_ID = $('#select_nganh').val();
            let _thm_ID = $('#select_tohopmon').val();
            let _dkxt_KQTQG_NamTotNghiep = $('#select_namtn').val();

            let _kxt_KQTQG_Diem_M1 = { TenMon: $('#lb_tenmon_1').text(), Diem: $('#txt_m1').val() };
            let _kxt_KQTQG_Diem_M2 = { TenMon: $('#lb_tenmon_2').text(), Diem: $('#txt_m2').val() };
            let _kxt_KQTQG_Diem_M3 = { TenMon: $('#lb_tenmon_3').text(), Diem: $('#txt_m3').val() };


            if (_nganh_ID == 0) { var errorMessage = "Vui lòng chọn ngành"; $('#Nganh_ID_Error').text(errorMessage); flag = false; }
            if (_thm_ID == 0) { var errorMessage = "Vui lòng chọn tổ hợp môn"; $('#Thm_ID_Error').text(errorMessage); flag = false; }
            if (_kxt_KQTQG_Diem_M1.DiemM1 == '' || _kxt_KQTQG_Diem_M2.DiemM2 == '' || _kxt_KQTQG_Diem_M3.DiemM3 == '') {
                var errorMessage = "Chưa nhập đủ điểm các môn hoặc nhập chưa đúng, vui lòng kiểm tra lại"; $('#Diem_All_Error').text(errorMessage); flag = false;
            }
            if (_dkxt_KQTQG_NamTotNghiep == 0) { var errorMessage = "Vui lòng chọn năm tốt nghiệp"; $('#NamTotNghiep_Error').text(errorMessage); flag = false; }

            if (!flag) return;

            let _dkxt_KQTQG_Diem_Tong = parseFloat(_kxt_KQTQG_Diem_M1.Diem) + parseFloat(_kxt_KQTQG_Diem_M2.Diem) + parseFloat(_kxt_KQTQG_Diem_M3.Diem);

            let _dkxt_KQTQG_MinhChung_CNTotNghiep = "";
            let _dkxt_KQTQG_MinhChung_HocBa = "";
            let _dkxt_KQTQG_MinhChung_BangTN = "";
            let _dkxt_KQTQG_MinhChung_CCCD = "";
            let _dkxt_KQTQG_MinhChung_UuTien = "";

            /* thực hiện upload file*/
            let so_file_cn_totnghiep = 0;
            let so_file_hocba_ts = 0;
            let so_file_bang_tn = 0;
            let so_file_cc_congdan = 0;
            let so_file_giayto_uutien = 0;

            let formData_All = new FormData();

            for (const item of formdata_file_chungnhan_kqtn) {
                formData_All.append(item[0], item[1]);
                so_file_cn_totnghiep++;
            }
            for (const item of formdata_file_hocba_ts) {
                formData_All.append(item[0], item[1]);
                so_file_hocba_ts++;
            }
            for (const item of formdata_file_bang_tn) {
                formData_All.append(item[0], item[1]);
                so_file_bang_tn++;
            }
            for (const item of formdata_file_cancuoc_congdan) {
                formData_All.append(item[0], item[1]);
                so_file_cc_congdan++;
            }
            for (const item of formdata_file_giayto_uutien) {
                formData_All.append(item[0], item[1]);
                so_file_giayto_uutien++;
            }

            formData_All.append('so_file_cn_totnghiep', so_file_cn_totnghiep);
            formData_All.append('so_file_hocba_ts', so_file_hocba_ts);
            formData_All.append('so_file_bang_tn', so_file_bang_tn);
            formData_All.append('so_file_cc_congdan', so_file_cc_congdan);
            formData_All.append('so_file_giayto_uutien', so_file_giayto_uutien);

            $.ajax({
                url: '/DangKyXetTuyens/DangKyXetTuyen_KQTHPTQG_UploadFile_Multi',
                type: "POST",
                contentType: false,
                processData: false,
                data: formData_All,
                async: false,
                success: function (res) {
                    _dkxt_KQTQG_MinhChung_CNTotNghiep = res._KQTQG_MinhChung_CNTotNghiep;
                    _dkxt_KQTQG_MinhChung_HocBa = res._KQTQG_MinhChung_HocBa;
                    _dkxt_KQTQG_MinhChung_BangTN = res._KQTQG_MinhChung_BangTN;
                    _dkxt_KQTQG_MinhChung_CCCD = res._KQTQG_MinhChung_CCCD;
                    _dkxt_KQTQG_MinhChung_UuTien = res._KQTQG_MinhChung_UuTien;
                },
                error: function (err) {
                    console.log(err.statusText);
                }
            });

            /*hết phần upload file*/

            /*phần khai báo đối tượng*/
            let data_Obj_edit = {
                Dkxt_KQTQG_ID: _dkxt_KQTQG_ID,
                Nganh_ID: _nganh_ID,
                Thm_ID: _thm_ID,
                Dkxt_KQTQG_NamTotNghiep: _dkxt_KQTQG_NamTotNghiep,

                Dkxt_KQTQG_Diem_M1: JSON.stringify(_kxt_KQTQG_Diem_M1),
                Dkxt_KQTQG_Diem_M2: JSON.stringify(_kxt_KQTQG_Diem_M2),
                Dkxt_KQTQG_Diem_M3: JSON.stringify(_kxt_KQTQG_Diem_M3),

                Dkxt_KQTQG_Diem_Tong: _dkxt_KQTQG_Diem_Tong.toString(),

                Dkxt_KQTQG_MinhChung_CNTotNghiep: _dkxt_KQTQG_MinhChung_CNTotNghiep,
                Dkxt_KQTQG_MinhChung_HocBa: _dkxt_KQTQG_MinhChung_HocBa,
                Dkxt_KQTQG_MinhChung_BangTN: _dkxt_KQTQG_MinhChung_BangTN,
                Dkxt_KQTQG_MinhChung_CCCD: _dkxt_KQTQG_MinhChung_CCCD,
                Dkxt_KQTQG_MinhChung_UuTien: _dkxt_KQTQG_MinhChung_UuTien,
            }
            /*hết phần khai báo đối tượng*/
            console.log(data_Obj_edit);


            $("#loadingModal").modal("show");
            $.ajax({
                url: "/DangKyXetTuyens/DangKyXetTuyen_KQTHPTQG_Edit",
                data: JSON.stringify(data_Obj_edit),
                type: 'POST',
                contentType: 'application/json;charset=utf-8',
                dataType: 'json',
                success: function (res) {
                    if (res.success) {
                        $("#loadingModal").modal("hide");
                        // hiển thị lại dữ liệu đã cập nhật
                        LoadDataInfor_THPTQG_ByID();
                        //hiển thị các hình ảnh minh chứng
                        LoadImageMC_THPTQG_ByID();
                        //thiết lập các upload file
                        reset_change_img_file();

                        showToast("Thông báo", "Cập nhật hồ sơ xét tuyển thành công!", "bg-error");
                        //window.location.href = "/DangKyXetTuyens/DkxtthptqgEdit" + str_query;
                        //  window.location.href = '/DangKyXetTuyens/Dkxtthptqg'
                    } else {
                        $("#loadingModal").modal("hide");
                        showToast("Thông báo", "Có lỗi xảy ra khi thêm mới nguyện vọng!", "bg-error");
                    }
                },
                error: function (errormessage) {
                    $("#loadingModal").modal("hide");
                    showToast("Thông báo", "Có lỗi xảy ra khi thêm mới nguyện vọng!", "bg-error");
                }
            });
        });

        // button tắt cửa sổ thêm mới phía trên
        $('#bt_close_div_update_aspirations_first').click(function () {
            window.location.href = '/DangKyXetTuyens/Dkxtthptqg'
        });
        // button tắt cửa sổ thêm mới phía dưới
        $('#bt_close_div_update_aspirations_second').click(function () {
            window.location.href = '/DangKyXetTuyens/Dkxtthptqg'
        });
    })


    function on_listen_fields_input_data(inputClass, outputClass) {
        var inputFields = $(inputClass);
        inputFields.on('input', function () {
            var allFilled = true;
            inputFields.each(function () {
                if ($(this).val() === '' || $(this).val() < 0 || $(this).val() > 10) {
                    allFilled = false;
                    var errorMessage = "Chưa nhập đủ điểm các môn hoặc nhập chưa đúng, vui lòng kiểm tra lại!";

                    $('#Diem_All_Error').text(errorMessage);
                    $(outputClass).val('');
                    return false;
                }
            });

            if (allFilled) {
                $('#Diem_All_Error').text('');
                let total = 0;
                inputFields.each(function () {
                    total += parseFloat($(this).val());
                });
                /* console.log(total / 3)*/
                $(outputClass).val((total).toFixed(2));
            }
        });
    }
    function hideErrorMessage(input) {
        var errorContainer = input.next('.text-danger');
        errorContainer.text('');
    }
    function select_khoinganh_view_data(khoinganh_key, nganh_key, tohopmon_key) {
        $('#select_khoinganh').empty()
        $.ajax({
            url: "/DangKyXetTuyens/KhoiNganhListAll",
            type: "GET",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            success: function (result_all) {
                $.each(result_all, function (i, result) {
                    $('#select_khoinganh').append('<option value="' + result.khoiNganh_ID + '">' + result.khoiNganh_Ten + '</option>');
                });
                $('#select_khoinganh').val(khoinganh_key);
                select_nganh_view_data(khoinganh_key, nganh_key, tohopmon_key);
            },
            error: function (errormessage) {
                console.log(errormessage.responseText);
            }
        });
    }
    function select_nganh_view_data(id, nganh_key, tohopmon_key) { // id = KhoiNganh_ID
        $("#select_nganh").empty();
        $.ajax({
            url: "/DangKyXetTuyens/NganhListAll/" + id,
            type: 'GET',
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (result_all) {

                $.each(result_all, function (i, result) {
                    $('#select_nganh').append('<option value="' + result.nganh_ID + '">' + result.nganh_GhiChu + '</option>');
                });

                $('#select_nganh').val(nganh_key);
                select_tohopmon_view_data(nganh_key, tohopmon_key);
            },
            error: function (errormessage) {
                console.log(errormessage.responseText);
            }
        });
    }
    function select_tohopmon_view_data(id, tohopmon_key) { // id = Nganh_ID
        $("#select_tohopmon").empty();
        $.ajax({
            url: "/DangKyXetTuyens/ToHopMonNganhListAll/" + id,
            type: 'GET',
            contentType: 'application/json;charset=utf-8',
            dataType: 'json',
            success: function (result_all) {
                $.each(result_all, function (i, result) {
                    $('#select_tohopmon').append('<option value="' + result.thm_ID + '">' + result.thm_MaTen + '</option>');
                });
                $('#select_tohopmon').val(tohopmon_key);
            },
            error: function (errormessage) {
                console.log(errormessage.responseText);
            }
        });
    }
    function reset_fields_controll_disabled_false() {

        $('#select_namtn').prop('disabled', false);

        $('#lb_tenmon_1').text("Chưa chọn");
        $('#lb_tenmon_2').text("Chưa chọn");
        $('#lb_tenmon_3').text("Chưa chọn");
        $('#lb_tongdiem').text('Tổng');

        $('.input-monhoc').val('');
        $('.input-tong').val('');

        $('#txt_m1').prop('disabled', false);
        $('#txt_m2').prop('disabled', false);
        $('#txt_m3').prop('disabled', false);
        $('#txt_tong_diem').prop('disabled', true);
        $('#txt_m1').focus();


        $('#files_chungnhan_kqtn').val(null);
        $('#files_hocba_ts').val(null);
        $('#files_bangtn').val(null);
        $('#files_cancuoc_congdan').val(null);
        $('#files_giayto_uutien').val(null);


        $("#FilesList_CNKQTN_View tbody").empty();
        $("#FilesList_HocBa_View tbody").empty();
        $("#FilesList_BangTN_View tbody").empty();
        $("#FilesList_CCCD_View tbody").empty();
        $("#FilesList_GTUT_View tbody").empty();


        $('#files_chungnhan_kqtn').prop('disabled', false);
        $('#files_hocba_ts').prop('disabled', false);
        $('#files_bangtn').prop('disabled', false);
        $('#files_cancuoc_congdan').prop('disabled', false);
        $('#files_giayto_uutien').prop('disabled', false);

    }
    function reset_fields_controll_disabled_true() {

        $('#select_namtn').prop('disabled', true);

        $('#lb_tenmon_1').text("Chưa chọn");
        $('#lb_tenmon_2').text("Chưa chọn");
        $('#lb_tenmon_3').text("Chưa chọn");
        $('#lb_tongdiem').text('Tổng');

        $('.input-monhoc').val('');
        $('.input-tong').val('');

        $('#txt_m1').prop('disabled', true);
        $('#txt_m2').prop('disabled', true);
        $('#txt_m3').prop('disabled', true);
        $('#txt_tong_diem').prop('disabled', true);

        $('#files_chungnhan_kqtn').val(null);
        $('#files_hocba_ts').val(null);
        $('#files_bangtn').val(null);
        $('#files_cancuoc_congdan').val(null);
        $('#files_giayto_uutien').val(null);


        $("#FilesList_CNKQTN_View tbody").empty();
        $("#FilesList_HocBa_View tbody").empty();
        $("#FilesList_BangTN_View tbody").empty();
        $("#FilesList_CCCD_View tbody").empty();
        $("#FilesList_GTUT_View tbody").empty();


        $('#files_chungnhan_kqtn').prop('disabled', true);
        $('#files_hocba_ts').prop('disabled', true);
        $('#files_bangtn').prop('disabled', true);
        $('#files_cancuoc_congdan').prop('disabled', true);
        $('#files_giayto_uutien').prop('disabled', true);
       
    }
    function showToast(title, message, bgColor) {
        $("#myToast .toast-header .me-auto").text(title);
        $("#myToast .toast-body").text(message);
        $("#myToast .toast").removeClass("bg-success bg-danger").addClass(bgColor);
        $("#myToast").toast("show");
    }
    $(document).ready(function () {
        $('#bt_xuat_phieu_tong_hop_kq').click(function () {
            window.location.href = '/ExportFile/DownloadFile_XetTuyenKQTQG';
        });
    });
</script>